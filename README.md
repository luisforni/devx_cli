![DevX CLI Banner](assets/devx_cli.png)

# DevX CLI ‚Äì Modular Console Toolkit

**DevX CLI** es una herramienta modular en consola que re√∫ne distintos servicios √∫tiles para desarrolladores y equipos t√©cnicos.  
Cada servicio se implementa como un m√≥dulo independiente con su propia l√≥gica y subcomando, lo que permite **reutilizar la l√≥gica en otros proyectos** y mantener el c√≥digo altamente escalable.

---

## Servicios incluidos

## 1Ô∏è‚É£ `health` ‚Äì Inspector de salud de proyectos
Analiza la estructura de un proyecto y detecta:
- Tama√±o total y archivos grandes.
- Variables de entorno usadas y no definidas.
- Dependencias desactualizadas.

**C√≥mo usar**
```bash
./devx.sh health run [ruta] [--large-mb 25]
```

**Linux / macOS**
```bash
# Ruta relativa (proyecto actual)
./devx.sh health run .

# Ruta absoluta
./devx.sh health run /home/usuario/proyectos/mi_app
```

**Windows (PowerShell)**
```bash
# Ruta relativa
bash devx.sh health run .

# Ruta absoluta
bash devx.sh health run C:\Users\Luis\Documents\Proyectos\mi_app
```

---

## 2Ô∏è‚É£ `loadtest` ‚Äì Simulador de carga para APIs
Permite probar la resistencia y latencia de un endpoint:
- Define **rps** (requests per second) y duraci√≥n.
- Soporta headers, payload y m√©todos HTTP.
- Muestra m√©tricas como latencia media, P95 y m√°xima.

**C√≥mo usar**
```bash
./devx.sh loadtest run <url> \
  [--rps 10] [--duration 10] [--method GET] \
  [--timeout 10.0] [--data '<json|texto>'] \
  [--headers '<json>'] [--verify-ssl/--no-verify-ssl]
```

**Linux / macOS**
```bash
./devx.sh loadtest run https://api.midominio.com/endpoint \
  --rps 15 --duration 8 \
  --headers '{"Authorization":"Bearer TOKEN123"}'
```

**Windows (PowerShell)**
```bash
bash devx.sh loadtest run https://api.midominio.com/endpoint `
  --rps 15 --duration 8 `
  --headers '{"Authorization":"Bearer TOKEN123"}'
```

---

## 3Ô∏è‚É£ `linkscan` ‚Äì Esc√°ner de enlaces rotos
Rastrea una web buscando enlaces internos rotos:
- Respeta el dominio de inicio.
- Muestra links con errores HTTP o inaccesibles.
- Ideal para mantenimiento SEO.

**C√≥mo usar**
```bash
./devx.sh linkscan run <url> [--limit 100] [--timeout 10.0]
```

**Linux / macOS**
```bash
./devx.sh linkscan run https://example.com --limit 50
```

**Windows (PowerShell)**
```bash
bash devx.sh linkscan run https://example.com --limit 50
```

---

## 4Ô∏è‚É£ `secrets` ‚Äì Detector de secretos en c√≥digo
Busca credenciales y tokens filtrados en repositorios:
- Patrones para AWS, JWT, API keys, contrase√±as, etc.
- Ignora binarios e im√°genes.
- √ötil como **pre-commit hook**.

**C√≥mo usar**
```bash
./devx.sh secrets run [ruta] [--ignore '<regex>']
```

**Linux / macOS**
```bash
./devx.sh secrets run /home/usuario/proyectos/mi_app
```

**Windows (PowerShell)**
```bash
bash devx.sh secrets run . --ignore "\.(png|jpg|jpeg|gif|pdf|zip|gz|tar|ico|lock|bin|pem|p12)$"
```

---

## 5Ô∏è‚É£ `docgen` ‚Äì Generador de documentaci√≥n Markdown
Crea documentaci√≥n autom√°tica a partir del c√≥digo:
- Extrae docstrings de m√≥dulos, clases y funciones.
- Genera un `.md` listo para subir a repositorios.
- Compatible con cualquier proyecto Python.

**C√≥mo usar**
```bash
./devx.sh docgen run [ruta] [--out DOCS.md]
```

**Linux / macOS**
```bash
./devx.sh docgen run /home/usuario/proyectos/mi_app --out /home/usuario/docs/MI_DOC.md
```

**Windows (PowerShell)**
```bash
bash devx.sh docgen run C:\Users\Luis\Documents\Proyectos\mi_app --out C:\Users\Luis\Documents\docs\MI_DOC.md
```

---

## 6Ô∏è‚É£ `securityscan` ‚Äì Esc√°ner b√°sico de seguridad web
- Analiza un sitio web y detecta configuraciones inseguras o faltantes:
- Headers de seguridad ausentes o d√©biles (CSP, X-Frame-Options, HSTS, etc.).
- Flags de cookies (`HttpOnly`, `Secure`, `SameSite`).
- Fingerprinting y posibles fugas de informaci√≥n.
- Estado del TLS y fecha de expiraci√≥n del certificado.
- Puertos web abiertos.
- Opcionalmente, analiza `<meta http-equiv>` en el HTML.

**C√≥mo usar**
```bash
./devx.sh securityscan run <url> [opciones]
```

**Linux / macOS**
```bash
./devx.sh securityscan run https://www.ejemplo.com
```

**Windows (PowerShell)**
```bash
bash devx.sh securityscan run https://www.ejemplo.com
```

**Ejemplo con salida JSON en directorio espec√≠fico**
```bash
./devx.sh securityscan run https://www.ejemplo.com --json resultado.json --out-dir ./reports
```

**Ejemplo r√°pido (sin escaneo de puertos ni TLS)**
```bash
./devx.sh securityscan run https://www.ejemplo.com --quick
```

**Opciones principales**
- `--json <archivo>` ‚Üí Guarda el resultado en formato JSON.
- `--out-dir <ruta>` ‚Üí Define el directorio donde guardar el reporte (se crea si no existe).
- `--quick` ‚Üí Salta el escaneo de puertos y chequeo TLS (m√°s r√°pido).
- `--fetch-html` ‚Üí Descarga HTML para analizar `<meta http-equiv>`.
- `--no-verify` ‚Üí No verifica certificados TLS (solo pruebas).
- `--force-http1` ‚Üí Fuerza HTTP/1.1 (desactiva HTTP/2).

---

## 7Ô∏è‚É£ `sbom` ‚Äì Generador de SBOM (CycloneDX)
Genera un **SBOM (Software Bill of Materials)** en formato **CycloneDX JSON** a partir del fichero `requirements.txt`.  
Adem√°s consulta la API de [osv.dev](https://osv.dev) para detectar posibles vulnerabilidades de seguridad en las dependencias.

**Ejemplo de salida JSON**
```bash
{
  "bomFormat": "CycloneDX",
  "specVersion": "1.5",
  "components": [
    {
      "type": "library",
      "name": "torch",
      "version": "2.7.1",
      "purl": "pkg:pypi/torch@2.7.1"
    }
  ],
  "_security": {
    "source": "osv.dev",
    "vulnerabilities_by_package": {
      "torch": [
        {
          "id": "GHSA-887c-mr87-cxwp",
          "title": null,
          "summary": null,
          "severity": null
        }
      ]
    }
  }
}
```

**C√≥mo usar**
```bash
./devx.sh sbom run <ruta_a_requirements.txt|pyproject.toml> [opciones]
```

**Linux / macOS**
```bash
./devx.sh sbom run /home/user/Documents/project/requirements.txt --resolve-installed --osv --osv-details --out sbom_osv.json
```

**Windows (PowerShell)**
```bash
bash devx.sh sbom run /home/user/Documents/project/requirements.txt --resolve-installed --osv --osv-details --out sbom_osv.json
```
---

## 8Ô∏è‚É£ `lint` ‚Äì Linter + Formateador

Ejecuta Ruff (detector de errores y malas pr√°cticas) y Black (formateador autom√°tico).
Permite revisar el c√≥digo de un proyecto o corregirlo autom√°ticamente con `--fix`.
Si se habilita integraci√≥n con Git, puede crear una rama de parche (`_fix/lint-YYYYMMDD-HHMMSS`) y hacer commit de los cambios.

**C√≥mo usar**
```bash
./devx.sh lint run <ruta_al_proyecto> [opciones]
```

**Linux / macOS**
```bash
./devx.sh lint run /home/user/Documents/project
./devx.sh lint run /home/user/Documents/project --fix
```

**Windows (PowerShell)**
```bash
bash devx.sh lint run C:/Users/user/Documents/project
bash devx.sh lint run C:/Users/user/Documents/project --fix
```

---

## 9Ô∏è‚É£ `depgraph` ‚Äì Analizador de dependencias e imports

Genera un grafo de dependencias de tu proyecto Python:
- Analiza todos los import en el c√≥digo fuente.
- Diferencia entre dependencias internas (m√≥dulos del proyecto) y externas (librer√≠as instaladas).
- Detecta ciclos de importaci√≥n peligrosos.
- Exporta resultados en DOT, PNG/SVG (requiere Graphviz) o JSON.

**C√≥mo usar**
```bash
./devx.sh depgraph run [ruta] [opciones]
```

**Linux / macOS**
```bash
# Grafo solo con dependencias internas en JSON
./devx.sh depgraph run . --out deps.json --include-externals false

# Grafo visual en PNG (requiere graphviz)
./devx.sh depgraph run . --out deps.png
```

**Windows (PowerShell)**
```bash
# Grafo solo con dependencias internas
bash devx.sh depgraph run . --out deps.json --include-externals false

# Grafo visual en PNG
bash devx.sh depgraph run . --out deps.png
```

**Ejemplo de salida JSON**
```bash
{
  "nodes": ["devx.cli", "devx.services.depgraph.cli", "devx.services.depgraph.analyzer"],
  "edges": [
    {"src": "devx.cli", "dst": "devx.services.depgraph.cli", "external": false},
    {"src": "devx.services.depgraph.cli", "dst": "typer", "external": true}
  ],
  "cycles": []
}
```

**Opciones principales**
- `--out <archivo>` ‚Üí Archivo de salida (`.json`, `.dot`, `.png`, `.svg`).
- `--include-externals [true|false]` ‚Üí Incluye o excluye librer√≠as externas.
- `--rankdir [TB|LR]` ‚Üí Orientaci√≥n del grafo (Top-Bottom o Left-Right).
- `--ignore '<regex>'` ‚Üí Excluir directorios adicionales (ej. `tests`, `build`).

```bash
./devx.sh depgraph run . --out deps.json --ignore build --ignore dist
./devx.sh depgraph run . --out deps.png --rankdir TB
./devx.sh depgraph run . --out deps.json --no-include-externals
```

---

## 1Ô∏è‚É£‚Äã0Ô∏è‚É£‚Äã `perf` ‚Äì Perfilador de rendimiento

Perfila un script Python y muestra las funciones m√°s costosas.

- **Por defecto:** usa `cProfile` y ense√±a un Top N (cumulative o time).
- **Opcional:** `--pyinstrument` para un reporte m√°s visual.
- Puede guardar el reporte en `reports/perf/` si pasas `--out`.

**Uso b√°sico**
```bash
./devx.sh perf run script.py
```

---

## 1Ô∏è‚É£‚Äã1Ô∏è‚É£‚Äã `coverage` ‚Äì Reporte de cobertura de tests

Ejecuta pytest con plugin `pytest-cov` y genera un informe de cobertura de c√≥digo.
Muestra una tabla resumida en consola y guarda los resultados en JSON dentro de `reports/coverage/`.

**‚öôÔ∏è Opciones principales**
- `--cov <m√≥dulo>` ‚Üí Ruta(s) a medir cobertura (repetible).
- `--out-dir <dir>` ‚Üí Carpeta donde guardar `coverage.json`.
- `--min-total <n>` ‚Üí Falla si el total de cobertura es menor al umbral.
- `--top <n>` ‚Üí Mostrar solo los N archivos con menor cobertura.
- `--workdir <dir>` ‚Üí Directorio de trabajo donde correr pytest.
- `--show-external` ‚Üí Mostrar tambi√©n archivos externos al proyecto (por defecto se ocultan).

**Uso b√°sico**
```bash
./devx.sh coverage run --cov devx --min-total 60
```

**Ejemplo de salida**
```bash
üß™ Coverage
Tests: tests
Targets: devx

Cobertura por archivo
‚îè‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î≥‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îì
‚îÉ File                       ‚îÉ Stmts ‚îÉ Miss  ‚îÉ Cover % ‚îÉ
‚î°‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚ïá‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚î©
‚îÇ devx/core/utils.py         ‚îÇ    30 ‚îÇ     2 ‚îÇ   93.3  ‚îÇ
‚îÇ devx/services/coverage/... ‚îÇ    54 ‚îÇ     5 ‚îÇ   90.7  ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î¥‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò

üìä Total: 91.2%
üíæ JSON: reports/coverage/coverage.json
```

## 1Ô∏è‚É£2Ô∏è‚É£ `dockercheck` ‚Äì Auditor√≠a de im√°genes Docker

Audita **Dockerfile** e im√°genes Docker para detectar malas pr√°cticas y optimizar el tama√±o final.

### üîé Qu√© hace
- Revisa **Dockerfile**:
  - Uso (o falta) de **multi-stage builds**.
  - Instrucciones que usan **root** en lugar de un usuario dedicado.
  - Capas redundantes o comandos `RUN` mal optimizados.
  - Orden recomendado de instrucciones (`COPY` antes de `RUN`, etc.).
- Chequea **imagen construida**:
  - Tama√±o total de la imagen.
  - Lista las capas m√°s pesadas (`docker history`).
- Genera reporte en tabla **Rich** con sugerencias, severidad e informe opcional en JSON.

**Uso b√°sico**
```bash
./devx.sh dockercheck run /home/user/Documents/project/Dockerfile
```

**Opciones:**
```bash
--image myapp:latest    Nombre/etiqueta de la imagen a construir
--max-size 500MB        Falla si la imagen supera el tama√±o indicado
--json-out              Guarda el reporte en JSON
```

---

## ‚ÑπÔ∏è Ayuda general

```bash
./devx.sh
./devx.sh <service> --help
./devx.sh <service> <command> --help

./devx.sh perf run /home/user/Documents/script.py --args "foo bar" --limit 15 --sort cumulative --out perf.json
./devx.sh perf run /home/user/Documents/script.py  --pyinstrument --out perf.txt
```

---

## C√≥mo ejecutar

```bash
# Ayuda general
./devx.sh
./devx.sh <service> --help
./devx.sh <service> <command> --help

# Ejemplos r√°pidos de cada servicio
./devx.sh health run .
./devx.sh loadtest run https://httpbin.org/get --rps 20 --duration 5
./devx.sh linkscan run https://example.com --limit 50
./devx.sh secrets run .
./devx.sh docgen run . --out DOCS.md
./devx.sh securityscan run https://www.ejemplo.com --quick
./devx.sh sbom run requirements.txt --osv --out reports/sbom/sbom.json
./devx.sh lint run /home/user/Documents/project --fix
./devx.sh depgraph run . --out deps.json
./devx.sh perf run /home/user/Documents/script.py
./devx.sh coverage run --cov devx --min-total 80
./devx.sh dockercheck run /home/user/Documents/project/Dockerfile
```
---

## C√≥mo ejecutar los tests

```bash
pytest -q
```

---

## Estructura del proyecto

```bash
devx_cli/
‚îú‚îÄ‚îÄ .gitignore
‚îú‚îÄ‚îÄ README.md
‚îú‚îÄ‚îÄ assets
‚îÇ   ‚îî‚îÄ‚îÄ devx_cli.png
‚îú‚îÄ‚îÄ devx
‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îú‚îÄ‚îÄ __main__.py
‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ   ‚îú‚îÄ‚îÄ core
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ config.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ http.py
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ logging.py
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ utils.py
‚îÇ   ‚îî‚îÄ‚îÄ services
‚îÇ       ‚îú‚îÄ‚îÄ coverage
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ runner.py
‚îÇ       ‚îú‚îÄ‚îÄ depgraph
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ analyzer.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ cli.py
‚îÇ       ‚îú‚îÄ‚îÄ docgen
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ generator.py
‚îÇ       ‚îú‚îÄ‚îÄ dockercheck
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ analyzer.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ runner.py
‚îÇ       ‚îú‚îÄ‚îÄ health
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ scanner.py
‚îÇ       ‚îú‚îÄ‚îÄ linkscan
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ crawler.py
‚îÇ       ‚îú‚îÄ‚îÄ lint
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ git_utils.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ runner.py
‚îÇ       ‚îú‚îÄ‚îÄ loadtest
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ engine.py
‚îÇ       ‚îú‚îÄ‚îÄ perf
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ profiler.py
‚îÇ       ‚îú‚îÄ‚îÄ sbom
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ cli.py
‚îÇ       ‚îú‚îÄ‚îÄ secrets
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ __init__.py
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ cli.py
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ rules.py
‚îÇ       ‚îî‚îÄ‚îÄ securityscan
‚îÇ           ‚îú‚îÄ‚îÄ __init__.py
‚îÇ           ‚îú‚îÄ‚îÄ analyzer.py
‚îÇ           ‚îî‚îÄ‚îÄ cli.py
‚îú‚îÄ‚îÄ devx.sh
‚îú‚îÄ‚îÄ pyproject.toml
‚îú‚îÄ‚îÄ reports
‚îÇ   ‚îú‚îÄ‚îÄ coverage
‚îÇ   ‚îú‚îÄ‚îÄ depgraph
‚îÇ   ‚îú‚îÄ‚îÄ dockercheck
‚îÇ   ‚îú‚îÄ‚îÄ perf
‚îÇ   ‚îú‚îÄ‚îÄ sbom
‚îÇ   ‚îî‚îÄ‚îÄ securityscan
‚îú‚îÄ‚îÄ requirements.txt
‚îú‚îÄ‚îÄ scripts
‚îÇ   ‚îú‚îÄ‚îÄ logo_ascii.txt
‚îÇ   ‚îî‚îÄ‚îÄ post_run_help.txt
‚îî‚îÄ‚îÄ tests
    ‚îú‚îÄ‚îÄ conftest.py
    ‚îú‚îÄ‚îÄ test_coverage.py
    ‚îú‚îÄ‚îÄ test_depgraph.py
    ‚îú‚îÄ‚îÄ test_docgen.py
    ‚îú‚îÄ‚îÄ test_dockercheck.py
    ‚îú‚îÄ‚îÄ test_health.py
    ‚îú‚îÄ‚îÄ test_linkscan.py
    ‚îú‚îÄ‚îÄ test_lint.py
    ‚îú‚îÄ‚îÄ test_loadtest.py
    ‚îú‚îÄ‚îÄ test_perf.py
    ‚îú‚îÄ‚îÄ test_sbom.py
    ‚îú‚îÄ‚îÄ test_secrets.py
    ‚îî‚îÄ‚îÄ test_securityscan.py
```

---

## Notas finales
- Cross-platform: Funciona en Linux, macOS y Windows (Git Bash).
- Extensible: F√°cil de a√±adir nuevos m√≥dulos de servicio.
- Reutilizable: La l√≥gica de cada servicio puede usarse fuera del CLI.

